<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Anamnese Orofacial - Fada dos Cílios</title>
  <link rel="stylesheet" href="../css/styleorofacial.css">
</head>

<body>

  <header>
    <h1>Fada dos Cílios</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="cilios.html">Extensão de Cílios</a></li>
        <li><a href="orofacial.html">Harmonização Orofacial</a></li>
        <li><a href="hidrolipo.html">Hidrolipoclasia Não Aspirativa</a></li>
      </ul>
    </nav>
  </header>

  <section class="hero">
    <div class="hero-content">
      <h2>Harmonização Orofacial</h2>
    </div>
  </section>

  <div class="form-container">
    <h2>Anamnese Orofacial</h2>
    <p>Um procedimento orofacial é um tratamento estético que visa melhorar a estética e a função do rosto e do sorriso,
      buscando o equilíbrio entre as duas. A harmonização orofacial (HOF) é um conjunto de procedimentos que podem ser
      realizados em diferentes áreas da face, como lábios, dentes, gengivas, nariz e queixo.</p>
    <br></br>
    <form id="formOrofacial" method="post">

      <div class="form-section">
        <h3>Informações Pessoais</h3>
        <div class="form-group">
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf" name="cpf" maxlength="14" required placeholder="123.456.789-00"
            pattern="\d{3}\.\d{3}\.\d{3}-\d{2}">
        </div>
        <div class="form-group">
          <label for="paciente">Paciente:</label>
          <input type="text" id="paciente" name="paciente" required placeholder="Digite o nome do paciente">
        </div>
        <div class="form-group">
          <label for="profissao">Profissão:</label>
          <input type="text" id="profissao" name="profissao" required placeholder="Ex: Desenvolvedor">
        </div>
        <div class="form-group">
          <label for="data_nascimento">Data de Nascimento:</label>
          <input type="date" id="data_nascimento" name="data_nascimento" required>
        </div>
        <div class="form-group">
          <label>Sexo: </label>
          <div class="radio-group">
            <label><input type="radio" name="sexo" value="Masculino" required> Masculino</label>
            <label><input type="radio" name="sexo" value="Feminino" required> Feminino</label>
            <label><input type="radio" name="sexo" value="Outro" required> Outro</label>
          </div>
        </div>
        <div class="form-group">
          <label for="endereco">Endereço:</label>
          <input type="text" id="endereco" name="endereco" required placeholder="EX: Rua joao das flores, 436">
        </div>
        <div class="form-group">
          <label for="cidade">Cidade:</label>
          <select id="cidade" name="cidade" required>
            <option value="">Selecione</option>
            <option value="São Paulo">São Paulo</option>
            <option value="Rio de Janeiro">Rio de Janeiro</option>
            <option value="Belo Horizonte">Belo Horizonte</option>
            <option value="Curitiba">Curitiba</option>
          </select>
        </div>
        <div class="form-group">
          <label for="telefone">Telefone:</label>
          <input type="text" id="telefone" name="telefone" maxlength="15" required placeholder="(XX) XXXXX-XXXX">
        </div>
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" required placeholder="teste@gmail.com">
        </div>
        <div class="form-group">
          <label for="indicado_por">Indicado por:</label>
          <input type="text" id="indicado_por" name="indicado_por" required placeholder="Ex: Wilson">
        </div>
      </div>

      <div class="form-section">
        <h3>Questionário</h3>
        
        <div class="form-group">
          <label>01 - Já fez algum tipo de tratamento estético?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="tratamento_estetico" value="Não"> Não</label>
            <label><input type="radio" name="tratamento_estetico" value="Sim"> Sim</label>
            <input type="text" id="tipo_tratamento_estetico" name="tipo_tratamento_estetico" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>02 - Tem alergia a algum medicamento?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="alergia_medicamento" value="Não"> Não</label>
            <label><input type="radio" name="alergia_medicamento" value="Sim"> Sim</label>
            <input type="text" id="alergia_qual" name="alergia_qual" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>03 - Faz uso de algum medicamento?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="uso_medicamento" value="Não"> Não</label>
            <label><input type="radio" name="uso_medicamento" value="Sim"> Sim</label>
            <input type="text" id="medicamento_qual" name="medicamento_qual" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>04 - Fumante?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="fumante" value="Não"> Não</label>
            <label><input type="radio" name="fumante" value="Sim"> Sim</label>
            <input type="text" id="fumante_obs" name="fumante_obs" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>05 - Utiliza ou já utilizou ácido na pele?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="acido_pele" value="Não"> Não</label>
            <label><input type="radio" name="acido_pele" value="Sim"> Sim</label>
            <input type="text" id="acido_obs" name="acido_obs" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>06 - Está sob algum tipo de tratameto médico?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="tratamento_medico" value="Não"> Não</label>
            <label><input type="radio" name="tratamento_medico" value="Sim"> Sim</label>
            <input type="text" id="tratamento_med_qual" name="tratamento_med_qual"
              placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>07 - Gestante</label>
          <div class="checkbox-group">
            <label><input type="radio" name="gestante" value="Não"> Não</label>
            <label><input type="radio" name="gestante" value="Sim"> Sim</label>
            <input type="text" id="tmp_gestacao" name="tmp_gestacao" placeholder="Especifique se aplicável">
          </div>

          <label>08 - Possui filhos?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="filhos" value="Não"> Não</label>
            <label><input type="radio" name="filhos" value="Sim"> Sim</label>
            <input type="text" id="qtd_de_filhos" name="qtd_de_filhos" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>09 - Possui algum problema de coração?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="problema_coracao" value="Não"> Não</label>
            <label><input type="radio" name="problema_coracao" value="Sim"> Sim</label>
            <input type="text" id="problema_coracao_qual" name="problema_coracao_qual" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>10 - Possui muita exposição ao Sol?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="exposicao_sol" value="Não"> Não</label>
            <label><input type="radio" name="exposicao_sol" value="Sim"> Sim</label>
            <input type="text" id="exposicao_sol_obs" name="exposicao_sol_obs" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>11 - Já teve algum tipo de câncer?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="cancer" value="Não"> Não</label>
            <label><input type="radio" name="cancer" value="Sim"> Sim</label>
            <input type="text" id="cancer_qual" name="cancer_qual" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>12 - Possui algum tipo de cuidado estético?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="cuidado_estetico" value="Não"> Não</label>
            <label><input type="radio" name="cuidado_estetico" value="Sim"> Sim</label>
            <input type="text" id="cuidado_qual" name="cuidado_qual" placeholder="Especifique se aplicável">
          </div>
        </div>

        <div class="form-group">
          <label>13 - Possui intolerância a Lactose?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="intolerancia_lactose" value="Não"> Não</label>
            <label><input type="radio" name="intolerancia_lactose" value="Sim"> Sim</label>
          </div>
        </div>

        <div class="form-group">
          <label>14 - Possui diabete?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="diabetes" value="Não"> Não</label>
            <label><input type="radio" name="diabetes" value="Sim"> Sim</label>
          </div>
        </div>

        <div class="form-group">
          <label>15 - Possui alergia a proteina de ovo (Albumina)?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="alergia_ovo" value="Não"> Não</label>
            <label><input type="radio" name="alergia_ovo" value="Sim"> Sim</label>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h3>Contato de Emergência</h3>
        <div class="form-group">
          <label for="emergencia_nome">Nome:</label>
          <input type="text" id="emergencia_nome" name="emergencia_nome" required>
        </div>

        <div class="form-group">
          <label for="emergencia_telefone">Telefone/Celular:</label>
          <input type="text" id="emergencia_telefone" name="emergencia_telefone" maxlength="15" required 
            placeholder="(XX) XXXXX-XXXX" oninput="formatarTelefoneEmergencia(this)">
        </div>
      </div>

      <div class="form-section">
        <h3>Termo de Responsabilidade</h3>
        <div class="form-group">
          <label>Você se compromete a seguir as orientações pós-procedimento?</label>
          <div class="checkbox-group">
            <label><input type="radio" name="compromisso_orientacoes" value="Sim"> Sim</label>
            <label><input type="radio" name="compromisso_orientacoes" value="Não"> Não</label>
          </div>
        </div>

        <div class="form-group">
          <label for="data_termo">Data:</label>
          <input type="date" id="data_termo" name="data_termo" required>
        </div>

        <div class="form-group">
          <label for="assinatura">Assinatura do Paciente:</label>
          <input type="text" id="assinatura" name="assinatura" required placeholder="Digite seu nome completo">
        </div>
        <p>Estou ciente e de acordo com todas as informações acima relacionadas.</p>
        <br>
        <div class="form-group">
          <label for="termo_concordo">
            <input type="checkbox" id="termo_concordo" name="termo_concordo" required>
            Declaro que li e concordo com as informações acima
          </label>
        </div>
      </div>

      <button type="submit" class="submit-btn">Enviar Formulário</button>
    </form>
  </div>

  <footer>
    <p>&copy; 2024 Fada dos Cílios. Todos os direitos reservados.</p>
    <div class="social-links">
      <a href="#" aria-label="Facebook">Facebook</a> |
      <a href="#" aria-label="Instagram">Instagram</a> |
      <a href="#" aria-label="WhatsApp">WhatsApp</a>
    </div>
  </footer>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>
      function formatCpf(cpfInput) {
          let value = cpfInput.value.replace(/\D/g, "");
          value = value.replace(/(\d{3})(\d)/, "$1.$2");
          value = value.replace(/(\d{3})(\d)/, "$1.$2");
          value = value.replace(/(\d{3})(\d{2})$/, "$1-$2");
          cpfInput.value = value;
      }

      function formatPhone(telefoneInput) {
          let value = telefoneInput.value.replace(/\D/g, "");
          value = value.replace(/(\d{2})(\d)/, "($1) $2");
          value = value.replace(/(\d{5})(\d)/, "$1-$2");
          telefoneInput.value = value;
      }

      function formatarTelefoneEmergencia(telefoneInput) {
      let value = telefoneInput.value.replace(/\D/g, "");
      value = value.replace(/(\d{2})(\d)/, "($1) $2");
      value = value.replace(/(\d{5})(\d)/, "$1-$2");
      telefoneInput.value = value;
    }      

      function showSuccessPopup() {
          alert("Formulário enviado com sucesso!");
      }

      function checkCpfExists(cpf) {
          return localStorage.getItem(cpf) !== null;
      }

      function fillFormWithData(cpf) {
          const userData = JSON.parse(localStorage.getItem(cpf));
          document.getElementById("paciente").value = userData.paciente;
          document.getElementById("profissao").value = userData.profissao;
          document.getElementById("data_nascimento").value = userData.dataNascimento;
          document.getElementById("telefone").value = userData.telefone;
          document.getElementById("email").value = userData.email;
          document.getElementById("endereco").value = userData.endereco;
          document.getElementById("cidade").value = userData.cidade;
      }

      function saveFormData() {
          const formData = {
          paciente: document.getElementById("paciente").value,
          profissao: document.getElementById("profissao").value,
          dataNascimento: document.getElementById("data_nascimento").value,
          telefone: document.getElementById("telefone").value,
          email: document.getElementById("email").value,
          endereco: document.getElementById("endereco").value,
          cidade: document.getElementById("cidade").value,
          indicadoPor: document.getElementById("indicado_por").value,
          sexo: document.querySelector('input[name="sexo"]:checked')?.value
          };
          localStorage.setItem(document.getElementById("cpf").value.replace(/\D/g, ""), JSON.stringify(formData));
      }

      function handleFormSubmit() {
          const cpfInput = document.getElementById("cpf").value.replace(/\D/g, "");
          if (!checkCpfExists(cpfInput)) {
              saveFormData();
          }
          
          document.getElementById("formOrofacial").submit();
      }

      function handleCpfBlur() {
          const cpfValue = document.getElementById("cpf").value.replace(/\D/g, "");
          if (checkCpfExists(cpfValue)) {
              alert("Este CPF já foi registrado. Os dados serão preenchidos automaticamente.");
              fillFormWithData(cpfValue);
          }
      }

      $(document).ready(function () {
    $('#formOrofacial').submit(function (event) {
      event.preventDefault();
      var formData = $(this).serialize();

      $.ajax({
        url: '/fada-dos-cilios/assets/php/processo_orofacial.php',
        type: 'POST',
        data: formData,
        success: function (response) {
          showSuccessPopup();
          $('#formOrofacial')[0].reset();
        },
        error: function () {
          alert('Ocorreu um erro ao enviar a mensagem. Tente novamente.');
        }
      });
    });
  });

      window.onload = function () {
          const cpfInput = document.getElementById("cpf");
          const telefoneInput = document.getElementById("telefone");
          cpfInput.oninput = () => formatCpf(cpfInput);
          telefoneInput.oninput = () => formatPhone(telefoneInput);

          const cpfValue = cpfInput.value.replace(/\D/g, "");
          if (checkCpfExists(cpfValue)) {
              fillFormWithData(cpfValue);
          }

          cpfInput.onblur = handleCpfBlur;
      };
  </script>
</body>

</html>